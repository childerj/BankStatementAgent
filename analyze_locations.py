"""
Analyze the BAI2 data to extract location information
"""

bai2_data = """01,103112594,627334,250721,1220,2166,,,2/
02,627334,103112594,1,250714,,USD,2/
03,110672806,,010,785229,,Z/
88,015,1389923,,Z/
88,040,785229,,Z/
88,045,1389923,,Z/
88,072,000,,Z/
88,074,000,,Z/
88,100,921896,6,Z/
88,400,317202,6,Z/
88,075,,,Z/
88,079,,,Z/
16,106,93105,Z,1393232989,0000000613,Checking Deposit,/
16,106,325375,Z,1393232988,0000000617,Checking Deposit,/
16,106,99397,Z,1393232987,0000000621,Checking Deposit,/
16,106,119129,Z,1393232986,0000000657,Checking Deposit,/
16,106,54300,Z,1393232985,0000000688,Checking Deposit,/
16,106,230590,Z,1393232984,0000000693,Checking Deposit,/
16,469,13000,Z,1393232983,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0617 STILLWA/
88,TER            CCD 0617 STILLWATER,OK,/
16,469,34309,Z,1393232982,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0688 OWASSO,/
88,OK             CCD 0688 OWASSO,OK,/
16,469,36951,Z,1393232981,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0657 BROKEN /
88,ARR            CCD 0657 BROKEN ARROW,OK,/
16,469,47900,Z,1393232980,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0693 SKIATOO/
88,K,O            CCD 0693 SKIATOOK,OK,/
16,469,74153,Z,1393232979,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0621 CLAREMO/
88,RE,            CCD 0621 CLAREMORE,OK,/
16,469,110889,Z,1393232978,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/14 0613 PONCA C/
88,ITY            CCD 0613 PONCA CITY,OK,/
49,6828500,35/
98,6828500,1,37/
02,627334,103112594,1,250715,,USD,2/
03,110672806,,010,1389923,,Z/
88,015,1893217,,Z/
88,040,1389923,,Z/
88,045,1893217,,Z/
88,072,000,,Z/
88,074,000,,Z/
88,100,503294,6,Z/
88,400,0,0,Z/
88,075,,,Z/
88,079,,,Z/
16,106,49309,Z,1393232977,0000000613,Checking Deposit,/
16,106,27435,Z,1393232976,0000000617,Checking Deposit,/
16,106,75358,Z,1393232975,0000000621,Checking Deposit,/
16,106,43856,Z,1393232974,0000000657,Checking Deposit,/
16,106,243236,Z,1393232973,0000000688,Checking Deposit,/
16,106,64100,Z,1393232972,0000000693,Checking Deposit,/
49,7572868,17/
98,7572868,1,19/
02,627334,103112594,1,250716,,USD,2/
03,110672806,,010,1893217,,Z/
88,015,745625,,Z/
88,040,1893217,,Z/
88,045,745625,,Z/
88,072,000,,Z/
88,074,000,,Z/
88,100,247598,6,Z/
88,400,1395190,12,Z/
88,075,,,Z/
88,079,,,Z/
16,106,28356,Z,1393232971,0000000613,Checking Deposit,/
16,106,49971,Z,1393232970,0000000617,Checking Deposit,/
16,106,52832,Z,1393232969,0000000621,Checking Deposit,/
16,106,23579,Z,1393232968,0000000657,Checking Deposit,/
16,106,77760,Z,1393232967,0000000688,Checking Deposit,/
16,106,15100,Z,1393232966,0000000693,Checking Deposit,/
16,469,27435,Z,1393232965,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0617 STILLWA/
88,TER            CCD 0617 STILLWATER,OK,/
16,469,43856,Z,1393232964,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0657 BROKEN /
88,ARR            CCD 0657 BROKEN ARROW,OK,/
16,469,49309,Z,1393232963,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0613 PONCA C/
88,ITY            CCD 0613 PONCA CITY,OK,/
16,469,54300,Z,1393232962,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0688 OWASSO,/
88,OK             CCD 0688 OWASSO,OK,/
16,469,64100,Z,1393232961,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0693 SKIATOO/
88,K,O            CCD 0693 SKIATOOK,OK,/
16,469,75358,Z,1393232960,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0621 CLAREMO/
88,RE,            CCD 0621 CLAREMORE,OK,/
16,469,93105,Z,1393232959,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0613 PONCA C/
88,ITY            CCD 0613 PONCA CITY,OK,/
16,469,99397,Z,1393232958,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0621 CLAREMO/
88,RE,            CCD 0621 CLAREMORE,OK,/
16,469,119129,Z,1393232957,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0657 BROKEN /
88,ARR            CCD 0657 BROKEN ARROW,OK,/
16,469,230590,Z,1393232956,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0693 SKIATOO/
88,K,O            CCD 0693 SKIATOOK,OK,/
16,469,243236,Z,1393232955,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0688 OWASSO,/
88,OK             CCD 0688 OWASSO,OK,/
16,469,295375,Z,1393232954,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/16 0617 STILLWA/
88,TER            CCD 0617 STILLWATER,OK,/
49,8563260,53/
98,8563260,1,55/
02,627334,103112594,1,250717,,USD,2/
03,110672806,,010,745625,,Z/
88,015,970286,,Z/
88,040,745625,,Z/
88,045,970286,,Z/
88,072,000,,Z/
88,074,000,,Z/
88,100,472259,4,Z/
88,400,247598,6,Z/
88,075,,,Z/
88,079,,,Z/
16,106,183795,Z,1393232953,0000000613,Checking Deposit,/
16,106,157149,Z,1393232952,0000000621,Checking Deposit,/
16,106,96215,Z,1393232951,0000000657,Checking Deposit,/
16,106,35100,Z,1393232950,0000000693,Checking Deposit,/
16,469,15100,Z,1393232949,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0693 SKIATOO/
88,K,O            CCD 0693 SKIATOOK,OK,/
16,469,23579,Z,1393232948,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0657 BROKEN /
88,ARR            CCD 0657 BROKEN ARROW,OK,/
16,469,28356,Z,1393232947,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0613 PONCA C/
88,ITY            CCD 0613 PONCA CITY,OK,/
16,469,49971,Z,1393232946,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0617 STILLWA/
88,TER            CCD 0617 STILLWATER,OK,/
16,469,52832,Z,1393232945,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0621 CLAREMO/
88,RE,            CCD 0621 CLAREMORE,OK,/
16,469,77760,Z,1393232944,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/17 0688 OWASSO,/
88,OK             CCD 0688 OWASSO,OK,/
49,4871536,33/
98,4871536,1,35/
02,627334,103112594,1,250718,,USD,2/
03,110672806,,010,970286,,Z/
88,015,1209939,,Z/
88,040,970286,,Z/
88,045,1209939,,Z/
88,072,000,,Z/
88,074,000,,Z/
88,100,711912,6,Z/
88,400,472259,4,Z/
88,075,,,Z/
88,079,,,Z/
16,106,136984,Z,1393232943,0000000613,Checking Deposit,/
16,106,103479,Z,1393232942,0000000617,Checking Deposit,/
16,106,103100,Z,1393232941,0000000621,Checking Deposit,/
16,106,64185,Z,1393232940,0000000657,Checking Deposit,/
16,106,292164,Z,1393232939,0000000688,Checking Deposit,/
16,106,12000,Z,1393232938,0000000693,Checking Deposit,/
16,469,35100,Z,1393232937,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/18 0693 SKIATOO/
88,K,O            CCD 0693 SKIATOOK,OK,/
16,469,96215,Z,1393232936,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/18 0657 BROKEN /
88,ARR            CCD 0657 BROKEN ARROW,OK,/
16,469,157149,Z,1393232935,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/18 0621 CLAREMO/
88,RE,            CCD 0621 CLAREMORE,OK,/
16,469,183795,Z,1393232934,,/
88,CONC DEBIT WORLD ACCEPTANCE 1570425114            25/07/18 0613 PONCA C/
88,ITY            CCD 0613 PONCA CITY,OK,/
49,6728792,29/
98,6728792,1,31/
99,34564956,5,179/"""

def extract_locations():
    """Extract and analyze location information from BAI2 data"""
    
    print("üè¢ LOCATION ANALYSIS FROM BAI2 DATA")
    print("=" * 50)
    
    locations = {}
    location_counts = {}
    
    lines = bai2_data.strip().split('\n')
    
    # Manually extract locations from the continuation lines
    location_mappings = [
        ('0617', 'STILLWATER, OK'),
        ('0688', 'OWASSO, OK'),  
        ('0657', 'BROKEN ARROW, OK'),
        ('0693', 'SKIATOOK, OK'),
        ('0621', 'CLAREMORE, OK'),
        ('0613', 'PONCA CITY, OK')
    ]
    
    # Initialize locations dictionary
    for code, name in location_mappings:
        locations[code] = name
        location_counts[code] = 0
    
    # Count occurrences
    for line in lines:
        for code, name in location_mappings:
            if code in line and 'WORLD ACCEPTANCE' in line:
                location_counts[code] += 1
    
    print("üìç UNIQUE LOCATIONS FOUND:")
    print("-" * 30)
    
    for code, name in sorted(locations.items()):
        count = location_counts.get(code, 0)
        print(f"   {code}: {name} (appears {count} times)")
    
    print(f"\nüìä TOTAL UNIQUE LOCATIONS: {len(locations)}")
    
    return locations, location_counts

if __name__ == "__main__":
    locations, location_counts = extract_locations()
    
    # Show the top 3 most frequent locations
    print(f"\nüéØ TOP 3 LOCATIONS (by frequency in data):")
    print("-" * 40)
    
    # Sort by frequency and show top 3
    sorted_locations = sorted(location_counts.items(), key=lambda x: x[1], reverse=True)
    
    for i, (code, count) in enumerate(sorted_locations[:3], 1):
        location_name = locations[code]
        print(f"   {i}. {code}: {location_name} (appears {count} times)")
    
    print(f"\nüèÜ ANSWER: The 3 locations in this BAI2 file are:")
    for i, (code, count) in enumerate(sorted_locations[:3], 1):
        location_name = locations[code] 
        print(f"   {i}. {location_name} (Location Code: {code})")
